{"version":3,"file":"index-DDfpcVJx.js","sources":["../../src/app.js"],"sourcesContent":["const input = document.getElementById('wordInput');\nconst button = document.getElementById('speakBtn');\nconst stopBtn = document.getElementById('stopBtn');\nconst manVoiceBtn = document.getElementById('manVoice');\nconst womanVoiceBtn = document.getElementById('womanVoice');\nconst languageSelect = document.getElementById('languageSelect');\nconst themeToggle = document.getElementById('themeToggle');\n\nlet selectedVoice = 'man'; // default to man voice\nlet voices = [];\nlet selectedLang = '';\nlet speechTimeouts = [];\n\n// Sanitize user input: trim, remove control characters, and cap length\nfunction sanitizeInput(rawValue) {\n  if (typeof rawValue !== 'string') return '';\n  const trimmed = rawValue.trim();\n  // Remove ASCII control chars and DEL\n  const withoutControls = trimmed.replace(/[\\u0000-\\u001F\\u007F]/g, '');\n  // Cap to 64 characters to avoid abuse\n  return withoutControls.slice(0, 64);\n}\n\n// Dark mode functionality\nfunction initTheme() {\n  const savedTheme = localStorage.getItem('theme') || 'light';\n  const html = document.documentElement;\n  html.setAttribute('data-theme', savedTheme);\n  updateThemeIcon(savedTheme);\n}\n\nfunction toggleTheme() {\n  const html = document.documentElement;\n  const currentTheme = html.getAttribute('data-theme') || 'light';\n  const newTheme = currentTheme === 'dark' ? 'light' : 'dark';\n  html.setAttribute('data-theme', newTheme);\n  localStorage.setItem('theme', newTheme);\n  updateThemeIcon(newTheme);\n}\n\nfunction updateThemeIcon(theme) {\n  if (themeToggle) {\n    const moonIcon = themeToggle.querySelector('.moon-icon');\n    const sunIcon = themeToggle.querySelector('.sun-icon');\n    if (moonIcon && sunIcon) {\n      if (theme === 'dark') {\n        moonIcon.classList.add('hidden');\n        sunIcon.classList.remove('hidden');\n      } else {\n        moonIcon.classList.remove('hidden');\n        sunIcon.classList.add('hidden');\n      }\n    }\n  }\n}\n\n// Initialize theme immediately\ninitTheme();\n\n// Add event listener when DOM is ready\nif (document.readyState === 'loading') {\n  document.addEventListener('DOMContentLoaded', () => {\n    if (themeToggle) {\n      themeToggle.addEventListener('click', toggleTheme);\n    }\n  });\n} else {\n  if (themeToggle) {\n    themeToggle.addEventListener('click', toggleTheme);\n  }\n}\n\nfunction loadVoices() {\n  voices = speechSynthesis.getVoices();\n  populateLanguageOptions();\n}\n\nfunction populateLanguageOptions() {\n  if (!languageSelect) return;\n  const seen = new Set();\n  const keepFirst = languageSelect.options[0];\n  languageSelect.innerHTML = '';\n  languageSelect.appendChild(keepFirst);\n  const langs = voices\n    .map(v => v.lang)\n    .filter(Boolean)\n    .filter(l => {\n      if (seen.has(l)) return false;\n      seen.add(l);\n      return true;\n    })\n    .sort((a, b) => a.localeCompare(b));\n  langs.forEach(l => {\n    const opt = document.createElement('option');\n    opt.value = l;\n    opt.textContent = formatLocaleLabel(l);\n    languageSelect.appendChild(opt);\n  });\n  \n  // Set English (United States) as default if not already set\n  if (!selectedLang) {\n    const lowerLangs = langs.map(l => l.toLowerCase());\n    const preferredOrder = ['en-gb', 'en-us'];\n    let chosen = '';\n    for (const pref of preferredOrder) {\n      const idx = lowerLangs.indexOf(pref);\n      if (idx !== -1) {\n        chosen = langs[idx];\n        break;\n      }\n    }\n    if (!chosen) {\n      // fallback to any English locale\n      const anyEn = langs.find(l => l.toLowerCase().startsWith('en'));\n      if (anyEn) chosen = anyEn;\n    }\n    if (chosen) selectedLang = chosen;\n  }\n  \n  if (selectedLang) languageSelect.value = selectedLang;\n}\n\n// Create human-friendly label for locale like \"English (United States) — en-US\"\nfunction formatLocaleLabel(locale) {\n  try {\n    const [lang, region] = locale.split(/[-_]/);\n    const languageDisplay = new Intl.DisplayNames(['en'], { type: 'language' });\n    const regionDisplay = new Intl.DisplayNames(['en'], { type: 'region' });\n    const langName = languageDisplay.of(lang) || lang;\n    const regionName = region ? regionDisplay.of(region.toUpperCase()) : '';\n    const pretty = regionName ? `${capitalize(langName)} (${regionName})` : capitalize(langName);\n    return `${pretty} — ${locale}`;\n  } catch {\n    return locale;\n  }\n}\n\nfunction capitalize(s) {\n  return typeof s === 'string' ? s.charAt(0).toUpperCase() + s.slice(1) : s;\n}\n\n// Load voices when they become available\nloadVoices();\nif (speechSynthesis.onvoiceschanged !== undefined) {\n  speechSynthesis.onvoiceschanged = loadVoices;\n}\n\nfunction getVoice() {\n  if (voices.length === 0) return null;\n  const langFiltered = selectedLang\n    ? voices.filter(v => v.lang === selectedLang)\n    : voices;\n\n  // Common female voice names to exclude when man is selected\n  const femaleNames = ['female', 'samantha', 'karen', 'susan', 'victoria', 'kate', 'zira', 'hazel', 'linda', 'lisa', 'maria', 'nancy', 'sarah'];\n  // Common male voice names to exclude when woman is selected\n  const maleNames = ['male', 'david', 'alex', 'daniel', 'thomas', 'james', 'john', 'mark', 'richard', 'michael', 'paul', 'steve'];\n\n  // Try to find gender-specific voices\n  const filteredVoices = langFiltered.filter(v => {\n    const name = v.name.toLowerCase();\n    if (selectedVoice === 'man') {\n      return name.includes('male') ||\n             name.includes('david') ||\n             name.includes('alex') ||\n             name.includes('daniel') ||\n             name.includes('thomas') ||\n             name.includes('james') ||\n             name.includes('john') ||\n             name.includes('mark') ||\n             name.includes('richard') ||\n             name.includes('michael');\n    } else {\n      return name.includes('female') ||\n             name.includes('samantha') ||\n             name.includes('karen') ||\n             name.includes('susan') ||\n             name.includes('victoria') ||\n             name.includes('kate') ||\n             name.includes('zira') ||\n             name.includes('hazel');\n    }\n  });\n\n  // If we found specific voices, use the first one\n  if (filteredVoices.length > 0) return filteredVoices[0];\n  \n  // If no specific match, filter out opposite gender voices\n  const oppositeGenderFiltered = langFiltered.filter(v => {\n    const name = v.name.toLowerCase();\n    if (selectedVoice === 'man') {\n      // Exclude female voices\n      return !femaleNames.some(femaleName => name.includes(femaleName));\n    } else {\n      // Exclude male voices\n      return !maleNames.some(maleName => name.includes(maleName));\n    }\n  });\n\n  // Use first voice that's not the opposite gender\n  if (oppositeGenderFiltered.length > 0) return oppositeGenderFiltered[0];\n  \n  // Last resort: try to use different voice indices to get different voices\n  // Often systems have multiple voices, and different indices might be different genders\n  if (langFiltered.length > 0) {\n    // Try to use different voice indices based on selection\n    // If man selected, try first voice; if woman, try a later voice\n    if (selectedVoice === 'man' && langFiltered.length > 0) {\n      return langFiltered[0];\n    } else if (selectedVoice === 'woman' && langFiltered.length > 1) {\n      // Use a different voice index for woman\n      const womanIndex = Math.min(1, langFiltered.length - 1);\n      return langFiltered[womanIndex];\n    }\n    return langFiltered[0];\n  }\n  return voices[0];\n}\n\nfunction stopSpeech() {\n  // Clear all pending timeouts\n  speechTimeouts.forEach(timeout => clearTimeout(timeout));\n  speechTimeouts = [];\n  \n  // Cancel any ongoing speech\n  if ('speechSynthesis' in window) {\n    speechSynthesis.cancel();\n  }\n}\n\nfunction spellWord(word) {\n  if (!('speechSynthesis' in window)) {\n    alert('Sorry, your browser does not support speech synthesis.');\n    return;\n  }\n  \n  // Stop any ongoing speech first\n  stopSpeech();\n  \n  const letters = word.split('');\n  const voice = getVoice();\n  \n  // Debug: log selected voice and voice being used\n  console.log('Selected voice type:', selectedVoice);\n  console.log('Voice being used:', voice ? voice.name : 'none');\n  \n  let delay = 0;\n  letters.forEach(letter => {\n    const utterance = new SpeechSynthesisUtterance(letter);\n    utterance.rate = 0.8;\n    \n    // Always set the voice if we have one\n    if (voice) {\n      utterance.voice = voice;\n    }\n    \n    utterance.lang = selectedLang || (voice && voice.lang) || '';\n    \n    // Adjust pitch for gender difference (default pitch is 1.0)\n    if (selectedVoice === 'man') {\n      utterance.pitch = 1; // Lower pitch for male voice\n    } else {\n      utterance.pitch = 1; // Higher pitch for female voice\n    }\n    \n    const timeout = setTimeout(() => {\n      speechSynthesis.speak(utterance);\n    }, delay);\n    speechTimeouts.push(timeout);\n    delay += 700;\n  });\n}\n\nmanVoiceBtn.addEventListener('click', () => {\n  selectedVoice = 'man';\n  manVoiceBtn.classList.add('active');\n  womanVoiceBtn.classList.remove('active');\n});\n\nwomanVoiceBtn.addEventListener('click', () => {\n  selectedVoice = 'woman';\n  womanVoiceBtn.classList.add('active');\n  manVoiceBtn.classList.remove('active');\n});\n\nlanguageSelect.addEventListener('change', () => {\n  selectedLang = languageSelect.value;\n});\n\nbutton.addEventListener('click', () => {\n  const word = sanitizeInput(input.value);\n  if (word) spellWord(word);\n});\n\nstopBtn.addEventListener('click', () => {\n  stopSpeech();\n});\n\ninput.addEventListener('keydown', e => {\n  if (e.key === 'Enter') button.click();\n});\n\n// Focus input on page load\nif (document.readyState === 'loading') {\n  document.addEventListener('DOMContentLoaded', () => {\n    if (input) input.focus();\n  });\n} else {\n  if (input) input.focus();\n}\n\n\n"],"names":["input","button","stopBtn","manVoiceBtn","womanVoiceBtn","languageSelect","themeToggle","selectedVoice","voices","selectedLang","speechTimeouts","sanitizeInput","rawValue","initTheme","savedTheme","updateThemeIcon","toggleTheme","html","newTheme","theme","moonIcon","sunIcon","loadVoices","populateLanguageOptions","seen","keepFirst","langs","v","l","a","b","opt","formatLocaleLabel","lowerLangs","preferredOrder","chosen","pref","idx","anyEn","locale","lang","region","languageDisplay","regionDisplay","langName","regionName","capitalize","s","getVoice","langFiltered","femaleNames","maleNames","filteredVoices","name","oppositeGenderFiltered","femaleName","maleName","womanIndex","stopSpeech","timeout","spellWord","word","letters","voice","delay","letter","utterance"],"mappings":"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"}